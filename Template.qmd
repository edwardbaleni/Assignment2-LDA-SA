---
title: "Assignment 2: Report"
author: "Edward Baleni, Andrea Plumbley, Luke Barnes"
format: html
editor: visual
---

## Abstract

Due to the large volume of text data available today, sentiment analysis and topic modelling have become popular methods to classify documents (or other pieces of text) based on their emotional content and topics or themes present. Sentiment analysis and topic modelling methods provide techniques to programmatically categorize documents and does not require individuals to sit and read through large documents. In this report, sentiment analysis and topic modelling is applied to State of the Nation Addresses in South Africa between 1994 and 2023. The sentiment analysis section allows one to identify different presidents sentiment conveyed in their speeches and how this changed over time. Topic modelling highlights what the major themes are that each president speaks about and if the proportion of time spent on each topic changes over time. The results of the sentiment analysis showed that on the whole South African presidents have a net positive sentiment in their speeches. Specifically Mandela and Mbeki became more positive in their speeches over the time of their presidency while Zuma and Ramaphosa become less positive during their time in office. These findings correlate with what was happening in South Africa at the times of their respective presidencies. Topic modelling extracted four key topics or themes which were given the following labels: Economic Growth, Social Development, Public Governance and Politics and Administration. The four topics were tracked over time for each president and results show how different presidents' different speeches contained varying levels of each of these four topics.

## Introduction

The aim of this assignment is to provide a descriptive analysis of the State of the Nation speeches in South Africa between 1994 and 2022. This descriptive analysis is performed using sentiment analysis and topic modelling. Sentiment analysis aims to describe the content of text in terms of its 'emotions' (Silge & Robinson, 2017). The purpose of performing sentiment analysis on these speeches is to identify the overall tone or emotion of the speech and identify how this might change over time or as presidents change. Topic modelling is a technique that aims to summarize text, in this case speeches, in terms of a number of topics. It is a way of categorizing speeches into different topics and identifying the main themes of a body of text (Silge & Robinson, 2017. This is of interest in order to identify what topics or themes are important in the context of the government of South Africa and how these themes or main topics may change over time or over different presidents.

Before the analysis is applied to the data a brief literature review will be given. Following this the data and any cleaning that was done will be discussed. The methods for performing sentiment analysis and topic modelling will be outlined. Finally the results of the analysis on the SONA speeches data will be presented and discussed.

Chat GPT was used as an aid to this assignment. The purpose of this was to experiment large language models and to assess Chat GPT's ability to assist with the assignment. A brief summary of how well it did and how it responded to different prompts and guides in given in Use of ChatGPT appendix (which can be found on Use of ChatGPT tab of this website).

## Literature Review

#### ***Sentiment Analysis***

Sentiment analysis is a technique to programmatically asses the emotional content of a text (Silge & Robinson, 2017). It gives a way, through the use of sentiment lexicons to understand the attitudes and opinions expressed in a piece of text or speech and identify if they are positive or negstive (Silge & Robinson, 2017). Sentiment analysis can also be seen as a classification method as it classifies documents into positive or negative categories or more sophiscated classes such as joy, disgust or anger, depending on which specific sentiment lexicon one is using in the analysis (Medhat et al., 2014). Due to the large amount of text data around today, sentiment analysis is becoming more popular and necessary in order to classify documents and arrange them in terms of sentiment because the volume is too large for documents to be manually sifted through by people to decide on its emotional contents (Medhat et al., 2014). There are a number of application areas for sentiment analysis including customer feedback and reviews, social media monitoring, market research and political analysis. In the context of the SONA data the sentiment analysis can be seen as a form of political analysis and also a way in which to describe how the country is doing in terms of governance and economy of the years from 1994 to 2023.

#### ***Topic Modelling***

Topic Modelling is a unsupervised classification technique for grouping documents according to topic or theme (Silge & Robinson, 2017). The particular topic modelling method that is popular is Latent Dirichlet Allocation (Silge & Robinson, 2017). The key ideas of this method is to consider documents as a collection of topics and topics as a collection of words (Silge & Robinson, 2017). Topic modelling thus allows one to categorize documents into broad themes and calculate the proportions of each topic or theme that appear in a document. Topic modelling has been done on SONA speeches before by Miranda and Bringula (2021) who analysed the State of the Nation Addresses in the Phillipines. Through the use of Latent Dirichlet Allocation, they were able to identify three major topics each linked with concerns within the country (Miranda & Bringula, 2021). In general one is able to pull out and label a topic by looking at the sentences that contain the words in that topic. This however needs to be discussed and consensus reached on what labels best represents the topic (Miranda & Bringula, 2021). This gives an indication that selecting the labels for topics is not always easy and may in some instances not represent perfectly the true underlying topic picked up by the LDA analysis.

## Data

As mentioned, the data for this analysis is a collection of 36 speeches delivered as State of the Nation Addresses between 1994 and 2022. These speeches were delivered by 6 different presidents: de Klerk, Mandela, Mbeki, Motlanthe, Zuma and Ramaphosa.

This data needed to be cleaned before sentiment analysis or topic modelling could be done. The data was cleaned by removing punctuation marks and numbers from the speeches. Stop words, which are common words such as 'the', 'and' and 'they' were also removed from the speeches.

In order to perform sentiment analysis the speeches needed to be tokenized into shorter parts such as bigrams and words in order to assess the sentiment of each smaller part and then aggregate these sentiments to understand the sentiment of the speech as a whole. The speeches are tokenized first into sentences and then into words using the unnest_tokens() function in R.

A separate analysis is done on bigrams in order to consider negation of words, for example 'improvement' vs 'no improvement', and to assess how frequently negation occurred. In order to perform this analysis the unnest_tokens() function was also done specifying the token argument to 'ngrams' and setting 'n' to 2. The same cleaning was done in order to remove numbers and punctuation marks before the speeches were tokenized in this way. In terms of stop word removal, stop words were removed except for those stop words that are negation words. The qdapDictionary::negation.words dictionary was used to identify negation words and remove them from the stop words before removing stop words from the analysis.

For topic modelling, for which Latent Dirichlet allocation will be applied, the data format that will be used is a DocumentTermMatrix object. Once the speeches have been tokenized and cleaned, as was done above, a DTM object is created using the cast_dtm() function which is part of the *tidytext* package in R. The cast_dtm() function is applied to the data frame containing the words, speechIDs and counts and turns the data frame into a DTM object using these variables.

## Methods

### *Sentiment Analysis*

In order to perform sentiment analysis, sentiment lexicons are used. These lexicons contain many words which are labelled according to their sentiment. The main lexicon that was made use of here for analysis was the *bing* dictionary which labels words as positive or negative. The *affin* dictionary gives each word a score between negative five and five, from negative to positive sentiments.

In order to get each words sentiment, the data frame containing individual words, with an associated president, year ans sentence ID is left joined with the *bing* lexicon in order to get their associated positive or negative sentiment. Because many of the words in the speeches are not in the dictionary, these words are assigned with a sentiment value of neutral instead of removing them from analysis. This is not an ideal situation as it may mean that words which are very emotively loaded are being assigned as neutral and so one could miss the true sentiment of a sentence or speech however it is better than removing all these words from the analysis completely.

In order to analyze the sentiment of different presidents we can consider each presidents most commonly used positive and negative words which can be found using filtering by president and filtering by positive or negative sentiment.

In addition one can consider how sentiment changes over time and by president by considering the number of positive and negative sentiment associated words and seeing how this changes over time. This can also be done using the filter() function and filtering by year. In this way one can see if the percentage of positive sentiment in a speech increased or decreased as well as identify the net sentiment of the SONA speeches over time.

Sentiment analysis, with unigram tokens, can effectively capture the sentiment associated with a word. However, there are instances where negation words precede these sentiments. Negation words are words that reverse the sentiment of a succeeding word in sentiment analysis, essentially reversing its polarity (AlGhamdi, 2022). In unigram-based sentiment analysis, it becomes necessary to account for this reversal in sentiment when negation words are present. Bigrams, which are pairs of consecutive words, prove to be valuable in investigating this phenomenon. Analyzing negation in conjunction with unigram sentiment helps assess whether some positive or negative sentiments might be incorrectly classified and whether the most frequently used positive/negative words truly represent a polar sentiment to the realization discussed.

The negation words used here have been drawn from the dictionary provided by (Rinker, T. W., 2013). It's important to note that this list of negation words is not exhaustive, and this limitation could affect the outcomes of the analysis.

To facilitate this process, the text was tokenized into bigrams. Following this, the words were separated, which allowed for the removal of stop words from the text. Negation words were collected, to handle contractions within some of these negation words, apostrophes were removed. Given that many negation words were found among the stop words, these negation terms were excluded from the stop word dictionary. Subsequently, the stop words were filtered out from the bigrams, resulting in a filtered dataset used for the analysis of bigram sentiment.

In cases where a bigram contained a negation word as the first of the two words, the sentiment was reversed. Afterward, an overall sentiment score was computed for each bigram to determine the sentiment associated with it.

### *Topic Modelling*

The second technique used to analyze the State of the Nation Addresses is topic modelling for which Latent Dirichlet allocation is used. The basic components of Latent Dirichlet Allocation (LDA) are as follows:

-   Each document (in this case speech) is made up of a mixture of topics.

-   Each topic is made up of a mixture of words.

If one wanted to generate a speech, first the number of words to generate must be specified. Following that one makes a draw from a Dirichlet distribution which gives a vector of proportions of each topic in the document. Then one divides up the number of words between the topics in the proportions specified. The words are then drawn from a conditional distribution which gives the probability of word i appearing given that the topic is topic j. LDA is therefore a hierarchical model, sampling first the topic proportions and then sampling the words given the topic proportions.

The *topicmodels* package is used in R in order to perform LDA on the SONA data using the LDA() function. A seed of 2023 is set within the LDA control argument in order to ensure results are reproducible. The LDA() function takes in as arguments the DocumentTermMatrix of the speeches, as discussed in the data section and a parameter k which specifies the number of topics one wants to obtain.

In terms of selecting the number of topics to look for, this has to be specified in the LDA() function when it is run. Miranda and Bringula (2021) selected three topics in analyzing the Philippines SONA speeches. For this analysis: two, three and four topics were considered. A few of the different results for these different numbers of topics will be presented in the results. It was found that four topics was best and were easiest to categorize into understandable labels. For this reason the majority of topic modelling results presented below are based on the four topic case.

It was found that in many cases the same words were appearing in many topics, particularly more common words like 'government', 'africa' and 'people'. In order to make the individual topics more meaningful these repeated words were set to only be allowed to be within one topic. This helped make the topics more unique so that better topic labels could be identified for each.

## Results and Discussion

Having outlined the methods used to perform sentiment analysis and topic modelling, the results and analysis of the speeches is now given.

### *Sentiment Analysis*

#### ***Individual Words***

Figure 1 below shows the most common positive words used by each president. A number of words stand out here. "Regard" is used very frequently by Mandela, Mbeki and Motlanthe while Zuma and Ramaphosa both say "support" often. Mandela and de Klerk's most common words are similar in terms of theme, examples being "freedom", "peaceful" and "reconciliation". These types of positive words are expected from these two presidents who were in office at the end of apartheid in South Africa.

It can also be noted that Ramaphosa and Zuma share similar positive words including "reform", "improve", "sustainable" and "progress" which indicates where much of their positive focus lies introducing new reforms or advocating for economic improvements and sustainable economic policy.

```{r, echo = FALSE, message=FALSE, warning=FALSE, include=FALSE}
### Libraries

library(tidyverse)
library(tidytext)
library(tokenizers)
library(gghighlight)
library(tictoc)
library(ggpubr)
library(topicmodels)

### Load Data

load("SonaData.RData")
load("dsfi-lexicons.Rdata")

### Separate speeches into sentences and sentences into words

unnest_reg = "[^\\w_#@']"

speechSentences = as_tibble(sona) %>%
  mutate(speechID = 1:36) %>%
  rename(president = president_13) %>%
  unnest_tokens(sentences, speech, token = "sentences") %>%
  select(speechID, president, year, sentences) %>%
  mutate(sentences, sentences = str_replace_all(sentences, "’", "'")) %>%
  mutate(sentences, sentences = str_replace_all(sentences, "'", "")) %>%
  mutate(sentences, sentences = str_remove_all(sentences, "[0-9]")) %>%
  mutate(sentID = row_number())

wordsWithSentID = speechSentences %>% 
  unnest_tokens(word, sentences, token = 'regex', pattern = unnest_reg) %>%
  filter(str_detect(word, '[a-z]')) %>%
  filter(!word %in% stop_words$word) %>%
  select(sentID, speechID, president, year, word)

### Join with Sentiment Lexicon

wordsSentiment = wordsWithSentID %>% 
  left_join(bing, by = "word") %>%
  rename(bing_sentiment = sentiment) %>%
  mutate(bing_sentiment = ifelse(is.na(bing_sentiment), "neutral", bing_sentiment))

#head(wordsSentiment)
#table(wordsSentiment$bing_sentiment)

```

```{r, echo = FALSE}
## Each Presidents Top 15 Most Frequent Positive words
## Top 5 is highlighted

P1 = wordsSentiment %>%
  filter(president == "Mandela") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Mandela") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 6)

P2 = wordsSentiment %>%
  filter(president == "Mbeki") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Mbeki") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P3 = wordsSentiment %>%
  filter(president == "Motlanthe") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  #filter(id <= 15) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Motlanthe") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P4 = wordsSentiment %>%
  filter(president == "Ramaphosa") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  #filter(id <= 15) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Ramaphosa") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P5 = wordsSentiment %>%
  filter(president == "Zuma") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Zuma") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P6 = wordsSentiment %>%
  filter(president == "deKlerk") %>%
  filter(bing_sentiment == "positive") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "purple", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("deKlerk") +
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

ggarrange(P1, P2, P3, P4, P5, P6, ncol=3, nrow=2)
```

[*Figure 1: The most commonly used positive words used by each president.*]{.underline}

Figure 2 below shows the most frequently used negative word by each president. Again here, as with the positive sentiment words, a couple words stand out which can highlight what the major issues at the time of each presidency. For Mbeki and Motlanthe, the most common negative sentiment word is poverty which indicates that that was a large problem at the time of their presidency or a negative aspect of the country that was focused on significantly in their speeches. Ramaphosa and Zuma use "corruption" many times in their speeches and this again points to what was regarded by them as a major negative issue to be addresses. In addition to corruption they both also speak of crime and poverty fairly frequently.

```{r, echo = FALSE}
## Each Presidents Most Frequent Negative words
## Top 5 is highlighted

P1 = wordsSentiment %>%
  filter(president == "Mandela") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Mandela") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P2 = wordsSentiment %>%
  filter(president == "Mbeki") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Mbeki") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P3 = wordsSentiment %>%
  filter(president == "Motlanthe") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Motlanthe") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P4 = wordsSentiment %>%
  filter(president == "Ramaphosa") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Ramaphosa") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P5 = wordsSentiment %>%
  filter(president == "Zuma") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("Zuma") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

P6 = wordsSentiment %>%
  filter(president == "deKlerk") %>%
  filter(bing_sentiment == "negative") %>%
  count(word) %>%
  #filter(rank(desc(n)) <= 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 15) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col(fill = "orange", col = "black") + 
  coord_flip() + 
  xlab(" ") + ylab("Frequency") + ggtitle("de Klerk") + 
  theme_bw(base_size = 12) +
  gghighlight(id <= 5)

ggarrange(P1, P2, P3, P4, P5, P6, ncol=3, nrow=2)


```

[*Figure 2: The most commonly used negative words used by each president.*]{.underline}

Having considered overall the most commonly used positive and negative words by each president which gives an idea of what the positive and negative issues of the country were at the time, sentiment changes over time are now considered. Figure A and B in Appendix 1 give the changes in positive and negative sentiment associated words over time. Figure 3 below gives the net change in sentiment overtime, where each president is represented by a different symbol shown in the legend. This net sentiment shows the net positive sentiments over negative sentiments. It is clear that overall most presidents have net positive speeches, using more positive than negative words. An exception to this is de Klerk where the value is just less than zero indicating more negative words than positive ones were said and Mandela's 1998 speech had an almost equal amount of negative and positive words. It must again be noted that those words not present in the *bing* dictionary were set as neutral and so there may be words that would slightly change these net sentiment values.

Mbeki and Ramaphosa stand out as having the highest net positive sentiment. Between 2003 and 2005 the SONA speeches were significantly more positive than negative during Mbeki's presidency. Ramaphosa's 2019 State of the Nation address also has a high net positive value. This was the year that Ramaphosa was elected as president and before the start of the COVID-19 pandemic and so it makes intuitive sense that this specific speech of Ramaphosa's was the largest in net positive sentiment as it was likely a hopeful speech talking about change that would come after Zuma's presidency and attempted impeachment.

The speeches from 2020 to 2023 decreased significantly in net positive sentiment which makes sense due to the COVID-19 pandemic and its economic impact on the country. However overall these SONA speeches were still overall positive than negative but not as positive as Ramaphosa first official SONA as president (2019).

```{r, echo=FALSE}
 
## Net Sentiment of Speech

wordsSentiment %>%
  group_by(year, president, bing_sentiment) %>%
  filter(bing_sentiment == "negative" | bing_sentiment == "positive") %>%
  count(bing_sentiment) %>%
  ungroup(bing_sentiment) %>%
  mutate(netSent = n - first(n)) %>%
  filter(bing_sentiment == "positive") %>%
  ggplot(aes(x = year, y = netSent, shape = president)) + 
  geom_point(col = "red", size = 5, stroke = 2) +
  xlab("Year") + ylab("Number of Net Positive Sentiments in Speech") + 
  theme_bw(base_size = 12) + 
  scale_x_discrete(name = "Year", 
                   breaks = c("1994","1999","2004", "2009", 
                              "2014", "2019", "2023")) +
  scale_shape_manual(values = c(5, 15, 1, 18, 0, 16)) 
```

[*Figure 3: Net positive sentiment in speeches over the years.*]{.underline}

Figure 4 below gives the change in net positive sentiment over each of the presidents terms in office. For de Klerk and Motlanthe this is not applicable because they each only delivered one address. Mandela and Mbeki became increasing positive in their speeches over their presidencies which Zuma and Ramaphosa delivered speeches that were less and less positive. It is expected that Mandela and Mbeki would have become increasingly more positive as their presidencies covered a time in which democracy was new in South Africa and significant changes made in government from the apartheid era which increased positive sentiment in the country. In the case of Zuma a decrease in positive sentiment makes sense as particularly toward the end of his presidency he was facing numerous allegations of corruption which likely would have impacted his speech sentiment. As already mentioned the second year of Ramaphosa's presidency saw the start of the pandemic which would have decreased the amount of positive sentiment in his speeches.

```{r, echo = FALSE}
## Change in Net Positive Sentiment between first and last speech

wordsSentiment %>%
  group_by(year, president, bing_sentiment) %>%
  filter(bing_sentiment == "negative" | bing_sentiment == "positive") %>%
  count(bing_sentiment) %>%
  ungroup(bing_sentiment) %>%
  mutate(netSent = n - first(n)) %>%
  filter(bing_sentiment == "positive") %>%
  ungroup(year) %>%
  mutate(changeNetSent = last(netSent) - netSent) %>% 
  filter(row_number() == 1) %>%
  ggplot(aes(x = as.factor(president), y = changeNetSent)) + 
  geom_bar(fill = "red", stat = "identity") +
  xlab("President") + ylab("Change in Net Positive Sentiments in Speech") + 
  theme_bw(base_size = 12) 
```

[*Figure 4: Change in Net Positive Sentiment between first and last speech, for each president.*]{.underline}

```{r, echo = FALSE, eval = FALSE}

## How often each president has said the top 10 most frequent positive words

wordsSentiment %>%
  filter(bing_sentiment == "positive") %>%
  count(president, word) %>%
  group_by(president) %>% 
  filter(rank(desc(n)) <= 10) %>%
  ggplot(aes(reorder(word, n), n)) + geom_col() + 
  facet_wrap(~president) + coord_flip() + xlab(" ")
```

#### *Bigrams*

```{r Negation, echo=FALSE}
# Tokenize into bigram
bigram <- speechSentences %>% 
  unnest_tokens(word, sentences, token = 'ngrams', n = 2)

# Collect some negation words from qdap dictionary
negation_words <-  qdapDictionaries::negation.words
clean <- function(x){
  hold <- str_replace_all(x, "’", "'")
  hold <- str_replace_all(x, "'", "")  
}
negation_words <- unlist(lapply(negation_words, clean))

# Remove negation words from list of stop words
stop_words <- stop_words %>%
  filter(!word %in% negation_words)


bigrams_separated <- bigram %>%
  separate(word, c("word1", "word2"), sep = " ")

# Filter out stop words
bigrams_filtered <- bigrams_separated %>%
  filter(!word1 %in% stop_words$word) %>%
  filter(!word2 %in% stop_words$word)

# Unite bigram
bigrams_unite <- bigrams_filtered %>%
  unite(word1, word2)

# Obtain the negated words
negated_words <- bigrams_filtered %>%
  filter(word1 %in% negation_words) %>%
  inner_join(afinn, by = c(word2 = "word")) %>%
  count(word1, word2, value, sort = TRUE) %>%
  arrange(desc(n))

# Sentiment of a bigram
# reverse the sentiment of word2 whenever it is preceded by a negation word, and then add up the number of positive and negative words within a bigram and take the difference.
bigrams_filtered <- bigrams_filtered %>% 
  # add sentiment for word 1
  left_join(bing, by = c(word1 = 'word')) %>%
  rename(sentiment1 = sentiment) %>%
  mutate(sentiment1 = ifelse(is.na(sentiment1), 'neutral', sentiment1)) %>%
  # add sentiment for word 2
  left_join(bing, by = c(word2 = 'word')) %>%
  rename(sentiment2 = sentiment) %>%
  mutate(sentiment2 = ifelse(is.na(sentiment2), 'neutral', sentiment2)) %>%
  select(word1, word2, sentiment1, sentiment2, everything())

# Reverse sentiment of negated words
bigrams_filtered <- bigrams_filtered %>%
  mutate(opp_sentiment2 = recode(sentiment2, 
                                 'positive' = 'negative',
                                 'negative' = 'positive',
                                 'neutral' = 'neutral')) %>%
  mutate(sentiment2 = ifelse(word1 %in% negation_words, opp_sentiment2, sentiment2)) %>%
  select(-opp_sentiment2)

# Obtaining the net sentiment of the bigrams
bigrams_filtered <- bigrams_filtered %>%
  mutate(net_sentiment = (sentiment1 == 'positive') + (sentiment2 == 'positive') - 
           (sentiment1 == 'negative') - (sentiment2 == 'negative')) %>%
  unite(bigram, word1, word2, sep = ' ', remove = FALSE)
```

```{r Negated Words per President, echo=FALSE}
s1 <- bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
  filter(president == "deKlerk") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
  arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) +   geom_col(fill = "purple", col = "black") + coord_flip() + ylab('Frequency')+ xlab("") + theme_bw() + ggtitle("deKlerk")

# Negative biagrams
s2 <- bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
    filter(president == "deKlerk") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + ylab('Frequency')+xlab("") + theme_bw(base_size = 12) + ggtitle("deKlerk")


s4 <- bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
    filter(president == "Zuma") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "purple", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 7) + ggtitle("Zuma")

# Negative biagrams
s5 <- bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
  filter(president == "Zuma") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 7) + ggtitle("Zuma")

s7 <- bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
  filter(president == "Ramaphosa") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "purple", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 7) + ggtitle("Ramaphosa")

# Negative biagrams
s8 <- bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
    filter(president == "Ramaphosa") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 12) + ggtitle("Ramaphosa")

s10 <-  bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
    filter(president == "Motlanthe") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) +  geom_col(fill = "purple", col = "black") + coord_flip() +ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 6) + ggtitle("Motlanthe")

# Negative biagrams
s11 <- bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
      filter(president == "Motlanthe") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 7) + ggtitle("Motlanthe")

s13 <-  bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
      filter(president == "Mbeki") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "purple", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 9) + ggtitle("Mbeki")

# Negative biagrams
s14 <-  bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
  filter(president == "Mbeki") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 9) + ggtitle("Mbeki")


s16 <- bigrams_filtered %>%
  filter(net_sentiment > 0) %>% # get positive bigrams
  filter(president == "Mandela") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n))  + geom_col(fill = "purple", col = "black") + coord_flip() + 
  ylab('Frequency')+ 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 7) + ggtitle("Mandela")

# Negative biagrams
s17 <- bigrams_filtered %>%
  filter(net_sentiment < 0) %>% # get negative bigrams
    filter(president == "Mandela") %>%
  count(bigram, sort = TRUE) %>%
  filter(rank(desc(n)) < 20) %>%
    arrange(desc(n)) %>%
  mutate(id = 1:dim(.)[1]) %>%
  filter(id <= 10) %>%
  ggplot(aes(reorder(bigram,n),n)) + geom_col(fill = "orange", col = "black") + coord_flip() + 
  ylab('Frequency') + 
  xlab("") + theme_bw(base_size = 12) +
  gghighlight(id <= 6) + ggtitle("Mandela")
```

The bigram sentiment analysis results are now presented and discussed. Three bigram sets are shown here, those that convey positive sentiment, those that convey negative sentiment and bigrams containing negated words.

In Figure 5, each president seems to have a number of repeating phrases that are meant to convey positive sentiment. These all seem to be rather unique to each individual. Both president's Ramaphosa and Zuma speak upon land reform, a very polarising topic dependent on who is asked. For those who have suffered the backlash of Apartheid, land reform is a very positive sentiment, however, for many who own land, land reform is a very negative sentiment. However, it is undestandable that this has been given a positive sentiment overall as the word reform means to improve upon.

Although these are supposed to be the presidents' positive sentiments, characters like de Klerk and Zuma do not subjectively convey a lot of positivity. Their statements are rather neutral. Their positive sentiment cannot be translated well. This may be a result of there possibly not being many positive items that they could have hoped to address. The bing dictionary may also not be a good dictionary for these two. De Klerk did, however, have a lot of positive sentiment about the freedom alliance.

Ramaphosa's positive sentiment seems to be very hopeful. He talks about plans, progress and steps forward. These ideas are indicative of a process or belief of a process to betterment. Mandela's positive sentiment worked around ideas of humanity. The reconcilliation commission, national unity, human dignity and affirmative action are all ideas that were professed in hopes of establishing a cooperative and friendlier social environment. Mbeki was very focused on the improvement of the country's economic status. Most of his positive sentiment includes words that invoke the idea of an increasing economy.

```{r Positive Bigrams per President, echo=FALSE}
ggarrange( s1, s4, s7, s10, s13, s16, ncol=2, nrow=3)
```

[*Figure 5: The most commonly used positive bigrams used by each president.*]{.underline}

In Figure 6, each president seems to have a number of repeating phrases that are meant to convey negative sentiment. Both Motlanthe and Mbeki happen to have very similar ideas in terms of their negative sentiment bigrams. This is understandable as Motlanthe took office after the resignation of Mbeki. It seems by looking at these plots of negative sentiment that these two presidents were dealing with crime and poverty.

Some of these sentiments in the negative plot are in fact quite positive and this shows a limitation of sentiment analysis. This shows how not every negation can be accounted for. For example, bigrams like criminal justice, poverty alleviation and anti corruption, have been shown to hold a negative meaning. These bigrams however have positive connotations. Anti corruption is the fight against something quite bad, that is corruption; criminal justice is the fight against crime; poverty alleviation is the mitigation of poverty. All these sentiments have been categorized as negative where in fact their meaning is quite positive. Such a realization puts into context some limitations that come about from the use of dictionaries that may have value some of these positive or negative as neutral, or not valued them at all. A similar limitation can be seen looking at Motlanthe and de Klerk with phrases such as 'metric poverty' and 'hard negotiations' being classified as negative when these may be neutral terms stating facts.

During Zuma's presidency, the negative sentiment that was expressed was undeniably negative. It seemed to be a period had greater amounts of corruption as the word corruption appears frquently in the bigrams. Apart from the attempt to combat corruption, the sentiment in Zuma's speeches does not seem to have any double meaning. The speaker seems to speak on the financial and economic crisis present in the country at the time.

Ramaphosa's negative sentiment is rather ambiguous. It is clear that at this time a very frequent topic was railways, employment, corruption and equality. The word rail has been given negative sentiment while it's accompanying words are either neutral or not defined in the bing dicitonary. It may not exactly be accurate to say that this rail is a negative sentiment. That along with critical skill and critical role, demonstrates that Ramaphosa's negative bigram sentiments were not able to capture the true meaning behind his statements.

```{r Negative Bigrams per President, echo=FALSE}
ggarrange( s2, s5, s8, s11, s14, s17, ncol=2, nrow=3)
```

[*Figure 6: The most commonly used negative bigrams used by each president.*]{.underline}

Figure C, D and E in the [Appendix](Appendix.qmd) show the use of negations in bigrams to identify if any positive words are frequently negated. It can be seen that negation words do appear frequently in these speeches or in front of other words. This is an important observation particularly for the positive individual words identified above. The fact that the negation of these positives happens infrequently indicates that on the whole the positive words identified are used within a positive context and are not negated.

### *Topic Modelling*

Having considered the sentiment analysis results of each speech, the topic modelling results are now presented.

As mentioned in the methods section, in order to specify an LDA model, one has to specify the number of topics one could expect to see in a document. Having selected this number of topics, the LDA will produces two outputs beta, $\beta$, and gamma, $\gamma$. Where $\beta$ is a parameter that gives the probability of a topic generating a particular word and $\gamma$ gives the proportions of topics in a document \url{IanDurbach.html}.

We first look into the $\beta$'s, the word-topic probabilities. To find a decent number of topics we ran 2, 3 and 4 topics in the LDA function and found that 4 topics gives the best result of the option. Both 2 and 3 topics had topics that had almost the same words as well as words with very similar meanings or themes. Although it is possible for topics to share some terms and meaning, the similarity of terms between topics was so great that it was difficult to distinguish the topics at all. When 4 topics were used, there were much clearer distinctions between the topics which can be seen in Figure 7.

```{r echo = FALSE}

speechTDF = wordsWithSentID %>%
  group_by(president, word) %>%
  count() %>%  
  ungroup() 

dtmSpeech = speechTDF %>% 
  cast_dtm(president, word, n)

kSeq = 2:4
topicsList = list()

for (k in kSeq){
  
  speechLDA = LDA(dtmSpeech, k = k, control = list(seed = 2023))
  
  speechTopics = tidy(speechLDA, matrix = 'beta')
  
  topicsList[[k-1]] = speechTopics
  
}

names(topicsList) = c("Two", "Three", "Four")

chosenTopic = topicsList$Four

```

In Figure 7, it can be seen that although there still remains some common terms, such as 'africa' and 'african', between some of the topics, majority of the words are unique to their topic. The words in each of the four topics seem to infer a potential idea or theme for each. Table 1 below gives the four topics along with their key words and sentences in which these words appear to help derive a meaningful label for each topic. This table may aid in demonstrating the meaning of each topic.

**Topic 1** contains words related to economic growth. This can be seen in how words like economy, investment, support, growth, sector and business fall into this topic. These are terms that are associated with economic behaviour and business.

**Topic 2** contains words related to social development. This can be seen with the inclusion of words such as people, development, ensure, regard, social and system. These words are related to social behaviour and the sentences containing these word speak about 'social development' and 'community workers'.

**Topic 3** contains words related to public governance / government policy. This can be seen in the inclusion of words like government, public, service, nation, parliament and democracy. These are all aspects that are related to government involvement. Associated sentences to these words include ideas around government taking action and implementing programmes.

**Topic 4** contains words associated with ideas related to politics and administration. This topic is rather ambiguous, which resulted in it taking on two main ideas. On the side of politics there are words like national, Africa, honourable, president and chairperson. Some sentences associated with these words demonstrate a sense of pride and contain an encouragement to support political leaders. On the side of administration there are words like programme, million, infrastructure and water. Associated sentences refer to the work that needs to be done in terms of infrastructure in the country and some of the plans of government to implement changes in this regard.

```{r echo = FALSE}

# keeping the term in the topic with the highest beta value

chosenTopic %>%
  group_by(term) %>%
  slice(which.max(beta)) %>%
  ungroup() %>%
  group_by(topic) %>%
  slice_max(n = 10, order_by = beta) %>% 
  ungroup() %>%
  arrange(topic, -beta) %>%
  ggplot(aes(reorder(term, beta), beta, fill = factor(topic))) +
  geom_col(show.legend = FALSE) +
  facet_wrap(~ topic, scales = 'free') + 
  coord_flip() + xlab(" ") +
  scale_fill_manual(values=c("black", "deeppink", "deepskyblue", "darkorchid")) +
  theme_bw(base_size = 12)

# Labels
## Topic 1: Economic Growth
## Topic 2: Social Development
## Topic 3: Public Governance / Government Policy 
## Topic 4: Politics and Admin

```

[*Figure 7: Top 10 Terms in each Topic by word-topic probability.*]{.underline}

[*Table 1: Example sentences to aid in depicting the meaning of topics*]{.underline}

| Topic | Label                       | Words                                            | Sentences                                                                                                                                                                                                                                                                                                                                                                                                                               |
|-----------------|-----------------|-----------------|---------------------|
| 1     | Economic Growth             | Economy, Investment, Growth, Business            | "The crisis cost our economy about 900 000 jobs." "To ensure the promotion of an inclusive economy, to aid growth and development..." "As part of our efforts to encourage greater economic growth, we are working to reduce the cost to communicate."                                                                                                                                                                                  |
| 2     | Social Development          | People, Development, Social, Improve             | "We must sustain and improve the effectiveness of our social development programmes..." "The government will create a public service echelon of multi-skilled community development workers..."                                                                                                                                                                                                                                         |
| 3     | Public Governance           | Government, Public, Service, Democracy           | "That will provide an opportunity to address the more detailed issues on the government's programme ... that will support the government's actions as our country begins its second decade of democracy." "In particular we have decided that this year the government itself, in all its spheres, and the public sector as a whole, must make a decisive and integrated contribution..."                                               |
| 4     | Politics and Administration | National, Compatriots, President, Infrastructure | "Compatriots and esteemed guests, local government must work." "We dare not allow any minority to deprive the great majority South Africans of their long-awaited desire to elect national and provincial governments which will for the first time in our history be truly representative of all South Africans." "Over the next few years, there will be a dramatic expansion ... for water, land care, municipal infrastructure\..." |

```{r echo = FALSE, eval = FALSE}

# compare terms with the greatest difference in Betas between topics
# plots are for all comparisons, assess and visualise for importance

wideBeta = function(speechTopics, k, thresh){
  
  if (k == 2){
    
    betaWide = speechTopics %>%
      mutate(topic = paste0("topic", topic)) %>%
      pivot_wider(names_from = topic, values_from = beta) %>% 
      filter(topic1 > thresh | topic2 > thresh) %>%
      mutate(log_ratio1.2 = log2(topic2 / topic1))
  }
  
  if (k == 3){
    
    betaWide = speechTopics %>%
      mutate(topic = paste0("topic", topic)) %>%
      pivot_wider(names_from = topic, values_from = beta) %>% 
      filter(topic1 > thresh | topic2 > thresh | topic3 > thresh) %>%
      mutate(log_ratio1.2 = log2(topic2 / topic1)) %>%
      mutate(log_ratio1.3 = log2(topic3 / topic1)) %>%
      mutate(log_ratio2.3 = log2(topic3 / topic2))
  }
  
  if (k == 4){
    
    betaWide = speechTopics %>%
      mutate(topic = paste0("topic", topic)) %>%
      pivot_wider(names_from = topic, values_from = beta) %>% 
      filter(topic1 > thresh | topic2 > thresh | topic3 > thresh | topic4 > thresh ) %>%
      mutate(log_ratio1.2 = log2(topic2 / topic1)) %>%
      mutate(log_ratio1.3 = log2(topic3 / topic1)) %>%
      mutate(log_ratio1.4 = log2(topic4 / topic1)) %>%
      mutate(log_ratio2.3 = log2(topic3 / topic2)) %>%
      mutate(log_ratio2.4 = log2(topic4 / topic2)) %>%
      mutate(log_ratio3.4 = log2(topic4 / topic3)) 
  }
  
  return(betaWide)
}

betaWide = wideBeta(chosenTopic, k = 4, thresh = 0.001)

betaWide %>%
  select(term, log_ratio1.2) %>%
  filter(abs(log_ratio1.2) >= 10) %>%
  mutate(pos = log_ratio1.2 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio1.2), log_ratio1.2, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 2 and 1") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

betaWide %>%
  select(term, log_ratio1.3) %>%
  filter(abs(log_ratio1.3) >= 50) %>%
  mutate(pos = log_ratio1.3 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio1.3), log_ratio1.3, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 3 and 1") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

betaWide %>%
  select(term, log_ratio1.4) %>%
  filter(abs(log_ratio1.4) >= 200) %>%
  mutate(pos = log_ratio1.4 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio1.4), log_ratio1.4, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 4 and 1") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

betaWide %>%
  select(term, log_ratio2.3) %>%
  filter(abs(log_ratio2.3) >= 10) %>%
  mutate(pos = log_ratio2.3 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio2.3), log_ratio2.3, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 3 and 2") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

betaWide %>%
  select(term, log_ratio2.4) %>%
  filter(abs(log_ratio2.4) >= 10) %>%
  mutate(pos = log_ratio2.4 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio2.4), log_ratio2.4, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 4 and 2") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

betaWide %>%
  select(term, log_ratio3.4) %>%
  filter(abs(log_ratio3.4) >= 100) %>%
  mutate(pos = log_ratio3.4 >= 0) %>%
  ggplot(aes(reorder(term, log_ratio3.4), log_ratio3.4, fill = pos)) +
  geom_bar(stat = "identity", position = 'dodge') + 
  coord_flip() + xlab("") + ylab("Beta Log Ratio between Topic 4 and 3") +
  scale_fill_manual(values=c("red", "blue")) +
  guides(fill = "none") +
  theme_bw(base_size = 12)

```

```{r echo = FALSE}

### Document-Topic Probabilities

speechTDF_DTP = wordsWithSentID %>%
  group_by(speechID, word) %>%
  count() %>%  
  ungroup()

dtmSpeech_DTP = speechTDF_DTP %>% 
  cast_dtm(speechID, word, n)

speechLDAforDTP = LDA(dtmSpeech_DTP, k = 4, control = list(seed = 2023))

gamma = tidy(speechLDAforDTP, matrix = 'gamma')
# gamma$gamma = round(gamma$gamma, 3)

speechGamma = left_join(speechSentences %>% 
                        mutate(speechID = as.character(speechID)) %>%
                        select(-sentences, -sentID), 
                        gamma,
                        by = c("speechID" = "document"),
                        relationship = "many-to-many") %>%
  group_by(speechID) %>%
  slice_head(n = 4) %>%
  ungroup() %>%
  mutate(gamma = round(gamma, 3))

deKlerk_gamma = speechGamma %>% filter(president=="deKlerk")
Motlanthe_gamma = speechGamma %>% filter(president=="Motlanthe")
```

Having considered the word-topic probabilities, the document-topic probabilities, $\gamma$'s, can now be considered which will give an indication of how much each president spoke about the four topics and if and how this changes over time. As mentioned previously the document-topic probabilities describe each document as a mixture of topics. It is helpful to analyze the proportions of a topic present in the document to understand the main theme of each speech and identify which topics were of most importance to each president.

In Figure 8, these $\gamma$'s are captured across the speeches allowing the visualization of trend in topic over time for each president. This would aid in identifying what the general idea of the speech at a given time was. The speeches given by de Klerk and Motlanthe are not in this plot because they each only gave one speech so changes over time cannot be considered.

Mandela's speeches was very focused on ideas of politics and admin. This makes sense as this was a period of transformation in government. Policy and administration were two very important points that needed to be tackled to escape the previously oppressive and hateful era. This emphasis on protecting the new government structure and politics is further reflected in how the topics of public governance are also strongly occurring topics in his speeches. Interesting the economic growth topic does not appear here. This shows a limitation of this analysis, because while Mandela may not have spoken about economic growth as much as later presidents, it definitely would have been part of his speeches and so should have been more present here.

The plot for Mbeki shows a much larger amount of change in topics between different speeches. In each of his speeches the dominating topic seems to shift. In his first and third speeches he seems to talk on politics and administration. In his second and sixth speech his dominating topic is that of social development. His fifth, eighth and nineth speeches deal with government policy. His fourth and seventh speech have a combination of ideas these different topics. In his last years of presidency, the main theme of his speeches was that of social development.

Zuma's speeches revolve around two topics, economic growth and government policy. The plot shows that most of his speeches changed between having one of these two topics as his main theme and they often switched in terms of which was more important over consecutive years.

Almost every speech that Ramaphosa has given strongly deals with the topics of economic growth, this is shown in the dominating document-topic probabilities of the topic over all of Ramphosa's speeches. This makes intuitive sense as much of Ramaphosa's presidency has been during the COVID-19 pandemic which had a large negative impact on the economy, thus requiring a need for economic growth and stimulation in the country. In his last two speeches it would seem that he gave more attention to politics and administration, while still focusing heavily on economic growth.

In de Klerk's single speech, he spoke about two topics. Topic 1 with a $\gamma$ value of 0.468 and Topic 4 with a $\gamma$ value of 0.532. His focus was therefore on both economic growth and politics and administration with slightly more of a focus on the latter topic. In Motlanthe's speech he had a $\gamma$ value of 1 for topic 2 which indicates that his speech primarily focused on social development. This makes sense as Motlanthe followed on from Mbeki whose last speeches also primarily focused on social development.

Topic Modelling use Latent Dirichlet Allocation has allowed for four key themes to be picked up in the SONA data from 1994 to 2023. These key topics have been outlined and have been able to be tracked over time. As mentioned there are some limitation in this analysis which include the fact that some topics contain words that convey similar meaning to word in other topics. This makes it challenging to identify labels and the labels identified here may not be exactly in line with what the true underlying topic may have been. Despite this, topic modelling gives one the ability to identify possible themes in each speech without requiring one to have listened to or read the whole speech. This makes topic modelling, and specifically LDA, a useful method as it automates the analysis of large volumes of text data.

```{r echo = FALSE}

# Gamma's are the speech topic probabilities

manData = speechGamma %>% 
  filter(president == "Mandela") %>% arrange(topic)

manPlotData = data.frame("Man.Len" = 1:length(unique(manData$speechID)),
                         "Man.Gam.Top1" = manData$gamma[1:7],
                         "Man.Gam.Top2" = manData$gamma[8:14],
                         "Man.Gam.Top3" = manData$gamma[15:21],
                         "Man.Gam.Top4" = manData$gamma[22:28])

man = ggplot(manPlotData, aes(x = as.factor(Man.Len))) +
  geom_point(aes(y = Man.Gam.Top1), col = "black", size = 4) +
  geom_point(aes(y = Man.Gam.Top2), col = "deeppink", size = 4) +
  geom_point(aes(y = Man.Gam.Top3), col = "deepskyblue", size = 4) +
  geom_point(aes(y = Man.Gam.Top4), col = "darkorchid", size = 4) +
  geom_line(aes(x = Man.Len, y = Man.Gam.Top1), col = "black", linewidth = 2) +
  geom_line(aes(x = Man.Len, y = Man.Gam.Top2), col = "deeppink", linewidth = 2) +
  geom_line(aes(x = Man.Len, y = Man.Gam.Top3), col = "deepskyblue", linewidth = 2) +
  geom_line(aes(x = Man.Len, y = Man.Gam.Top4), col = "darkorchid", linewidth = 2) +
  ylab("Gamma") + xlab("Speech") +
  theme_bw(base_size = 12) +
  ggtitle("Mandela")

mbeData = speechGamma %>% 
  filter(president == "Mbeki") %>% 
  mutate(speechID = as.integer(speechID)) %>%
  arrange(topic, speechID)

mbePlotData = data.frame("Mbe.Len" = 1:length(unique(mbeData$speechID)),
                         "Mbe.Gam.Top1" = mbeData$gamma[1:10],
                         "Mbe.Gam.Top2" = mbeData$gamma[11:20],
                         "Mbe.Gam.Top3" = mbeData$gamma[21:30],
                         "Mbe.Gam.Top4" = mbeData$gamma[31:40])

mbe = ggplot(mbePlotData, aes(x = as.factor(Mbe.Len))) +
  geom_point(aes(y = Mbe.Gam.Top1), col = "black", size = 4) +
  geom_point(aes(y = Mbe.Gam.Top2), col = "deeppink", size = 4) +
  geom_point(aes(y = Mbe.Gam.Top3), col = "deepskyblue", size = 4) +
  geom_point(aes(y = Mbe.Gam.Top4), col = "darkorchid", size = 4) +
  geom_line(aes(x = Mbe.Len, y = Mbe.Gam.Top1), col = "black", linewidth = 2) +
  geom_line(aes(x = Mbe.Len, y = Mbe.Gam.Top2), col = "deeppink", linewidth = 2) +
  geom_line(aes(x = Mbe.Len, y = Mbe.Gam.Top3), col = "deepskyblue", linewidth = 2) +
  geom_line(aes(x = Mbe.Len, y = Mbe.Gam.Top4), col = "darkorchid", linewidth = 2) +
  ylab("Gamma") + xlab("Speech") +
  theme_bw(base_size = 12) +
  ggtitle("Mbeki")

zumData = speechGamma %>% 
  filter(president == "Zuma") %>% 
  mutate(speechID = as.integer(speechID)) %>%
  arrange(topic, speechID)

zumPlotData = data.frame("Zum.Len" = 1:length(unique(zumData$speechID)),
                         "Zum.Gam.Top1" = zumData$gamma[1:10],
                         "Zum.Gam.Top2" = zumData$gamma[11:20],
                         "Zum.Gam.Top3" = zumData$gamma[21:30],
                         "Zum.Gam.Top4" = zumData$gamma[31:40])

zum = ggplot(zumPlotData, aes(x = as.factor(Zum.Len))) +
  geom_point(aes(y = Zum.Gam.Top1), col = "black", size = 4) +
  geom_point(aes(y = Zum.Gam.Top2), col = "deeppink", size = 4) +
  geom_point(aes(y = Zum.Gam.Top3), col = "deepskyblue", size = 4) +
  geom_point(aes(y = Zum.Gam.Top4), col = "darkorchid", size = 4) +
  geom_line(aes(x = Zum.Len, y = Zum.Gam.Top1), col = "black", linewidth = 2) +
  geom_line(aes(x = Zum.Len, y = Zum.Gam.Top2), col = "deeppink", linewidth = 2) +
  geom_line(aes(x = Zum.Len, y = Zum.Gam.Top3), col = "deepskyblue", linewidth = 2) +
  geom_line(aes(x = Zum.Len, y = Zum.Gam.Top4), col = "darkorchid", linewidth = 2) +
  ylab("Gamma") + xlab("Speech") +
  theme_bw(base_size = 12) +
  ggtitle("Zuma")

ramData = speechGamma %>% 
  filter(president == "Ramaphosa") %>% 
  mutate(speechID = as.integer(speechID)) %>%
  arrange(topic, speechID)

ramPlotData = data.frame("Ram.Len" = 1:length(unique(ramData$speechID)),
                         "Ram.Gam.Top1" = ramData$gamma[1:7],
                         "Ram.Gam.Top2" = ramData$gamma[8:14],
                         "Ram.Gam.Top3" = ramData$gamma[15:21],
                         "Ram.Gam.Top4" = ramData$gamma[22:28])

ram = ggplot(ramPlotData, aes(x = as.factor(Ram.Len))) +
  geom_point(aes(y = Ram.Gam.Top1), col = "black", size = 4) +
  geom_point(aes(y = Ram.Gam.Top2), col = "deeppink", size = 4) +
  geom_point(aes(y = Ram.Gam.Top3), col = "deepskyblue", size = 4) +
  geom_point(aes(y = Ram.Gam.Top4), col = "darkorchid", size = 4) +
  geom_line(aes(x = Ram.Len, y = Ram.Gam.Top1), col = "black", linewidth = 2) +
  geom_line(aes(x = Ram.Len, y = Ram.Gam.Top2), col = "deeppink", linewidth = 2) +
  geom_line(aes(x = Ram.Len, y = Ram.Gam.Top3), col = "deepskyblue", linewidth = 2) +
  geom_line(aes(x = Ram.Len, y = Ram.Gam.Top4), col = "darkorchid", linewidth = 2) +
  ylab("Gamma") + xlab("Speech") +
  theme_bw(base_size = 12) +
  ggtitle("Ramaphosa")

ggarrange(man, mbe, zum, ram, ncol = 2, nrow = 2)
```

[*Figure 8: The trend in topic over time for each president's speeches.*]{.underline}

```{r echo=FALSE, eval=FALSE}

### Finding sentences for each Topic
# includes the sentences with the gammas

sentencesGamma = left_join(speechSentences %>% 
                             mutate(speechID = as.character(speechID)), 
                           gamma,
                           by = c("speechID" = "document"),
                           relationship = "many-to-many") %>%
  mutate(gamma = round(gamma, 3))


sonaSentences = as_tibble(sona) %>%
  mutate(speechID = 1:36) %>%
  rename(president = president_13) %>%
  unnest_tokens(sentences, speech, token = "sentences") %>%
  select(speechID, president, year, sentences) %>%
  mutate(sentID = row_number())

### Topic 1: Economic Growth

sentencesGamma %>%
  filter(grepl("economy", sentences) & topic == 1 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 4744 | sentID == 4779) %>%
  select(sentences)

ss$sentences

# "The crisis cost our economy about 900 000 jobs."
# "To ensure the promotion of an inclusive economy, to aid growth and development, we have established the broad-based black economic empowerment advisory council, chaired by the president."

sentencesGamma %>%
  filter(grepl("investment", sentences) & topic == 1 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 4771) %>%
  select(sentences)

ss$sentences

# "Underpinning our strategy for economic recovery and growth, is our capital investment programme."

sentencesGamma %>%
  filter(grepl("economic growth", sentences) & topic == 1 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 4877) %>%
  select(sentences)

ss$sentences

# "As part of our efforts to encourage greater economic growth, we are working to reduce the cost to communicate."

### Topic 2: Social Development

sentencesGamma %>%
  filter(grepl("social development", sentences) & topic == 2 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 3617) %>%
  select(sentences)

ss$sentences

# "We must sustain and improve the effectiveness of our social development programmes targeted at providing a cushion of support to those most exposed to the threat of abject poverty..."

sentencesGamma %>%
  filter(grepl("development", sentences) & topic == 2 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 2665) %>%
  select(sentences)

ss$sentences

# "The government will create a public service echelon of multi-skilled community development workers who will maintain direct contact with the people where these masses live."

### Topic 3: Public Governance

sentencesGamma %>%
  filter(grepl("government", sentences) & grepl("democracy", sentences) & topic == 3 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 6053) %>%
  select(sentences)

ss$sentences

# "That will provide an opportunity to address the more detailed issues on the government's programme ... that will support the government's actions as our country begins its second decade of democracy."

sentencesGamma %>%
  filter(grepl("government", sentences) & grepl("public", sentences) & topic == 3 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 2060) %>%
  select(sentences)

ss$sentences

# "In particular we have decided that this year the government itself, in all its spheres, and the public sector as a whole, must make a decisive and integrated contribution..."

sentencesGamma %>%
  filter(grepl("service", sentences) & grepl("public", sentences) & topic == 3 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 5562) %>%
  select(sentences)

ss$sentences

# "Ensuring that the public services we provide our people today can continue to be provided to our people tomorrow, requires that we have suitable tax policies to generate sufficient revenue to pay for these services."

### Topic 4: Politics and Administration

sentencesGamma %>%
  filter(grepl("compatriots", sentences) & topic == 1 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 4845 | sentID == 4742) %>%
  select(sentences)

ss$sentences

# "Compatriots and esteemed guests,  local government must work."

sentencesGamma %>%
  filter(grepl("national", sentences) & grepl("africa", sentences) & topic == 4 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 215) %>%
  select(sentences)

ss$sentences

# "We dare not allow any minority to deprive the great majority South Africans of their long-awaited desire to elect national and provincial governments which will for the first time in our history be truly representative of all South Africans."

sentencesGamma %>%
  filter(grepl("water", sentences) & grepl("infrastructure", sentences) & topic == 4 & gamma > 0.5) %>%
  print(n = 20)

ss = sonaSentences %>%
  filter(sentID == 1602) %>%
  select(sentences)

ss$sentences

# "Over the next few years, there will be a dramatic expansion ... for water, land care, municipal infrastructure and selected welfare projects."

```

## Conclusion

This report has outlined a descriptive analysis of the State of the Nation speeches in South Africa between 1994 and 2023. This descriptive analysis was carried out by implementing sentiment analysis and topic modelling on the speech data. This analysis has highlighted the importance of being able to manipulate and wrangle text data in order to convert it into useful formats. In addition it has shown how both sentiment analysis and topic modelling are useful tools to extract meaning from text data without having to read through the full speeches. The sentiment analysis showed the positive or negative sentiments of each president and described how these sentiments changed over time. Significant increases or decreases in positive sentiment were also able to be noted. The topic modelling technique pulled out four topics that the presidents conveyed in their speeches. These topics were able to be tracked over time for each president which gave insight into which topics different presidents thought were more or less important to speak about. There are some limitations to the analysis that has been done such as the lack of certain words in the sentiment lexicons and assumptions of 'neutral' words. In addition, for the topic modelling, there is no set number of topics that should be chosen and so a potential limitation is not conducting more analysis with varying numbers of topics. Overall this report has given an overview of how to conduct a descriptive analysis of text data and has highlighted two popular techniques, sentiment analysis and topic modelling.

## References

AlGhamdi, Najwa, Shaheen Khatoon, and Majed Alshamari. 2022. "Multi-Aspect Oriented Sentiment Classification: Prior Knowledge Topic Modelling and Ensemble Learning Classifier Approach" Applied Sciences 12, no. 8: 4066. https://doi.org/10.3390/app12084066

Bringula, R., Ulfa, S., Miranda, J and Atienze, F. 2022. Text mining analysis on students' expectations and anxieties towards data analytics course. Cogent Engineering.

Miranda, J. and Bringula, R. 2021. Exploring Phillipine presidents' speeches: a sentiment analysis and topic modeling approach. Cogent Social Sciences.

Medhat, W., Hassan, A. and Korashy, H. 2014. Sentiment analysis algorithms and applications: a survey. Ain Shams Engineering Journal, 5(4).

R Core Team. 2022. R: A language and environment for statistical computing. R Foundation for Statistical Computing, Vienna, Austria. URL https://www.R-project.org/.

Rinker, T. W. (2013). qdapDictionaries: Dictionaries to Accompany the qdap Package. 1.0.7. University at Buffalo. Buffalo, New York. http://github.com/trinker/qdapDictionaries

Silge, J. and Robinson, D. 2016. Text Mining with R, A tidy approach. O'Reilly.

Silge, J. and Robinson, D. 2016. "tidytext: Text Mining and Analysis Using Tidy Data Principles in R." *JOSS*, *1*(3). doi:10.21105/joss.00037 https://doi.org/10.21105/joss.00037.

Wickham H., François R., Henry L., Müller K., Vaughan D. 2023. *dplyr: A Grammar of Data Manipulation*. R package version 1.1.3, https://CRAN.R-project.org/package=dplyr.

Wickham, H. 2022. *stringr: Simple, Consistent Wrappers for Common String Operations*. R package version 1.5.0, <https://CRAN.R-project.org/package=stringr>.
